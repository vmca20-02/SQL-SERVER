<!DOCTYPE HTML>

<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>body{font: 12.8px Sans-serif; line-height: 1.5em; width: 19cm; max-width: 100%;margin:auto;}pre{word-wrap: break-word;border: 1px solid #CCC; padding: 20px;background-color:#EEE;border-radius:5px;}</style>
</head>

<body>
<h2 id="ejercicio-48">Ejercicio 48</h2>
<p>Una empresa tiene registrados sus clientes en una tabla llamada &quot;clientes&quot;.</p>
<ol>
<li><p>Créela con la siguiente estructura:</p>
<ul>
<li><strong>codigo</strong>, <em>serial</em>.</li>
<li><strong>nombre</strong>, <em>varchar(30)</em>. not null</li>
<li><strong>domicilio</strong>, <em>varchar(30)</em>.</li>
<li><strong>ciudad</strong>, <em>varchar(20)</em>.</li>
<li><strong>provincia</strong>, <em>varchar</em>. (20)</li>
<li><strong>telefono</strong>, <em>varchar(11)</em>.</li>
<li><strong>primary key</strong>, <em>codigo</em>.</li>
</ul></li>
<li><p>Ingrese algunos registros:</p>
<ul>
<li><em>'López Marcos', 'Colon 111', 'Córdoba', 'Córdoba', 'null'</em>.</li>
<li><em>'Pérez Ana', 'San Martin 222', 'Cruz del Eje', 'Córdoba', '4578585'</em>.</li>
<li><em>'García Juan', 'Rivadavia 333', 'Villa del Rosario', 'Córdoba', '4578445'</em>.</li>
<li><em>'Pérez Luis', 'Sarmiento 444', 'Rosario', 'Santa Fe', null</em>.</li>
<li><em>'Pereyra Lucas', 'San Martin 555', 'Cruz del Eje', 'Córdoba', '4253685'</em>.</li>
<li><em>'Gómez Inés', 'San Martin 666', 'Santa Fe', 'Santa Fe', '0345252525'</em>.</li>
<li><em>'Torres Fabiola', 'Alem 777', 'Villa del Rosario', 'Córdoba', '4554455'</em>.</li>
<li><em>'López Carlos', null, 'Cruz del Eje', 'Córdoba', null</em>.</li>
<li><em>'Ramos Betina', 'San Martin 999', 'Córdoba', 'Córdoba', '4223366'</em>.</li>
<li><em>'López Lucas', 'San Martin 1010', 'Posadas', 'Misiones', '0457858745'</em>.</li>
</ul></li>
<li>Obtenga el total de los registros agrupados por ciudad y provincia (<em>6 filas</em>)</li>
<li><p>Obtenga el total de los registros agrupados por ciudad y provincia sin considerar los que tienen<br />menos de 2 clientes (<em>3 filas</em>)</p></li>
</ol>
<h3 id="resuelto">Resuelto</h3>
<pre><code>/** EJERCICIO 48
******************************************************************************/

DROP TABLE IF EXISTS clientes;
CREATE TABLE clientes (
    codigo SERIAL,
    nombre VARCHAR(30) NOT NULL,
    domicilio VARCHAR(30),
    ciudad VARCHAR(20),
    provincia VARCHAR (20),
    telefono VARCHAR(11),
    PRIMARY KEY(codigo)
);

INSERT INTO clientes(nombre,domicilio,ciudad,provincia,telefono)
    VALUES  (&#39;Lopez Marcos&#39;,&#39;Colon 111&#39;,&#39;Cordoba&#39;,&#39;Cordoba&#39;,&#39;NULL&#39;),
        (&#39;Perez Ana&#39;,&#39;San Martin 222&#39;,&#39;Cruz del Eje&#39;,&#39;Cordoba&#39;,&#39;4578585&#39;),
        (&#39;Garcia Juan&#39;,&#39;Rivadavia 333&#39;,&#39;Villa del Rosario&#39;,&#39;Cordoba&#39;,&#39;4578445&#39;),
        (&#39;Perez Luis&#39;,&#39;Sarmiento 444&#39;,&#39;Rosario&#39;,&#39;Santa Fe&#39;,NULL),
        (&#39;Pereyra Lucas&#39;,&#39;San Martin 555&#39;,&#39;Cruz del Eje&#39;,&#39;Cordoba&#39;,&#39;4253685&#39;),
        (&#39;Gomez Ines&#39;,&#39;San Martin 666&#39;,&#39;Santa Fe&#39;,&#39;Santa Fe&#39;,&#39;0345252525&#39;),
        (&#39;Torres Fabiola&#39;,&#39;Alem 777&#39;,&#39;Villa del Rosario&#39;,&#39;Cordoba&#39;,&#39;4554455&#39;),
        (&#39;Lopez Carlos&#39;,NULL,&#39;Cruz del Eje&#39;,&#39;Cordoba&#39;,NULL),
        (&#39;Ramos Betina&#39;,&#39;San Martin 999&#39;,&#39;Cordoba&#39;,&#39;Cordoba&#39;,&#39;4223366&#39;),
        (&#39;Lopez Lucas&#39;,&#39;San Martin 1010&#39;,&#39;Posadas&#39;,&#39;Misiones&#39;,&#39;0457858745&#39;);
        
SELECT ciudad, provincia,
    COUNT(*) AS cantidad
    FROM clientes
    GROUP BY ciudad,provincia;
    
SELECT ciudad, provincia,
    COUNT(*) AS cantidad
    FROM clientes
    GROUP BY ciudad,provincia
    HAVING COUNT(*) &gt; 1;
</code></pre>

</body>
</html>

